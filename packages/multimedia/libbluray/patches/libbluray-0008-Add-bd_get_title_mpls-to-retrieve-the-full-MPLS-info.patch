From 10cc67dae999401c3171d5e896a8a2cec20691aa Mon Sep 17 00:00:00 2001
From: Hendrik Leppkes <h.leppkes@gmail.com>
Date: Tue, 16 Feb 2016 19:09:21 +0100
Subject: [PATCH 8/9] Add bd_get_title_mpls to retrieve the full MPLS
 information from a title

---
 libbluray.def          |  1 +
 src/libbluray/bluray.c |  8 ++++++++
 src/libbluray/bluray.h | 10 ++++++++++
 3 files changed, 19 insertions(+)

diff --git a/libbluray.def b/libbluray.def
index a248cd2..d4c93cb 100644
--- a/libbluray.def
+++ b/libbluray.def
@@ -55,6 +55,7 @@ EXPORTS
                 bd_read_mobj
                 bd_free_mobj
                 bd_get_clip_infos
+                bd_get_title_mpls
 
                 ; additional functions
                 bd_set_debug_handler
diff --git a/src/libbluray/bluray.c b/src/libbluray/bluray.c
index 0c04d23..27beed7 100644
--- a/src/libbluray/bluray.c
+++ b/src/libbluray/bluray.c
@@ -3795,3 +3795,11 @@ int bd_get_clip_infos(BLURAY *bd, unsigned clip, uint64_t *clip_start_time, uint
     }
     return 0;
 }
+
+struct mpls_pl* bd_get_title_mpls(BLURAY * bd)
+{
+  if (bd && bd->title) {
+    return bd->title->pl;
+  }
+  return NULL;
+}
diff --git a/src/libbluray/bluray.h b/src/libbluray/bluray.h
index 16ef380..6e74df4 100644
--- a/src/libbluray/bluray.h
+++ b/src/libbluray/bluray.h
@@ -1063,6 +1063,16 @@ int bd_read_file(BLURAY *, const char *path, void **data, int64_t *size);
  */
 int bd_get_clip_infos(BLURAY *bd, unsigned clip, uint64_t *clip_start_time, uint64_t *stream_start_time, uint64_t *pos, uint64_t *duration);
 
+/**
+ * Get the MPLS struct of the current title
+ *
+ * @param bd BLURAY object
+ * @return the MPLS struct
+ *
+ * Lifetime of the MPLS pointer is limited to the lifetime of the BD title
+ */
+struct mpls_pl* bd_get_title_mpls(BLURAY * bd);
+
 #ifdef __cplusplus
 }
 #endif
-- 
1.9.3

